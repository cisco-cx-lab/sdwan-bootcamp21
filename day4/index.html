<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Day 4 Tasks - sdwan-bootcamp21</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Day 4 Tasks";
    var mkdocs_page_input_path = "day4.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> sdwan-bootcamp21</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Lab Guide</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../intro2/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../day1/">Day 1 Tasks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../day2/">Day 2 Tasks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../day3/">Day 3 Tasks</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Day 4 Tasks</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#submit-your-saved-files-from-day-4-task-to-box-folder">Submit your saved files from Day 4 task to box folder</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../survey/">Survey</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">sdwan-bootcamp21</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Lab Guide &raquo;</li>
        
      
    
    <li>Day 4 Tasks</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h3 id="34-day-4-tasks"><strong>3.4. Day 4 tasks</strong></h3>
<p>In Day 4 lab, you will:</p>
<ol>
<li>Enable <strong>DIA</strong> on BR3  </li>
<li>Convert QoS local marking policy to Central QoS policy</li>
<li>Enable Cloud OnRamp for SaaS with DIA site and Gateway site</li>
<li>Integrate with Umbrella using SIG tunnel</li>
</ol>
<p><strong>3.4.1. Direct Internet Access</strong> <br>
Configure DIA on BR3 to use local internet transport for internet-bound traffic. <br></p>
<ul>
<li>Verify public DNS server is defined under VPN0</li>
<li>Verify NAT is enabled on interface Gig1 with public-internet color</li>
<li>Change service side interface Gig3 IP address to <strong>10.30.1##.1/24</strong>, where the 3rd octet variable is your <strong>POD</strong> number. For example, <strong>POD1</strong> will configure Gig3 IP to <strong>10.30.101.1/24</strong>.</li>
<li>Login <strong>br3-vm1</strong> and change interface <strong>eth0</strong> IP address to <strong>10.30.1##.10/24</strong>, where the 3rd octet variable is your <strong>POD</strong> number. For example, <strong>POD1</strong> will configure Gig3 IP to <strong>10.30.101.10/24</strong>.</li>
<li>Change default route on <strong>br3-vm1</strong> to <strong>br3-cedge1</strong> 's Gig3 IP address</li>
</ul>
<p>To demonstrate the result of DIA, please capture and compare the output of <strong>'traceroute 19.1.7.10'</strong> from BR3_desk console. <br>
<code>viptela@ubuntu:~$ traceroute 19.1.7.10</code></p>
<p><strong>Note</strong>: save the before and after traceroute screenshots to a file    </p>
<p><strong>3.4.1b. Direct Internet Access With Tracker</strong> <br>
<strong>Note</strong>: Optional task
Disconnect the internet connection from POC Tool console for site BR3-LosAngeles. This will simulate a brownout failure.</p>
<p><img src="https://leitian123.github.io/sdwan-bootcamp21/img/3_4_1b.PNG" width="600"/> <br></p>
<p>Observe the this outage blackholing internet traffic for site BR3.
Configure Interface tracker to fix this issue.</p>
<p><strong>3.4.2. QoS Central policy</strong> <br>
To enforce QoS policy standardization across the fabric, change the local QoS marking policy configured in day 2 task to a centralized QoS policy and apply to all sites.</p>
<p><strong>Note</strong>: save the preview of updated central policy to a file.    </p>
<p><strong>3.4.3. Cloud OnRamp for SaaS</strong> <br>
Enable Cloud OnRamp for SaaS on vManage. Then follow the workflow to enable CoR SaaS for <strong>Salesforce</strong> with site BR4-RTP as DIA site.</p>
<p><strong>3.4.4. Umbrella SASE Integration</strong> <br>
In IOS XE 17.2.1r and later, auto tunneling to Umbrella as SIG is supported from vManage. In this task, you will follow the steps below to build a SIG tunnel to Umbrella from site <strong>BR3-LosAngeles</strong>. <br></p>
<ul>
<li>Create SIG template <strong>CX_SIG_v1</strong>, and configure interface <strong>ipsec#</strong> matches your <strong>POD</strong> number. For example, <strong>POD1</strong> will use <strong>ipsec1</strong>. For this lab, you will only create one ipsec interface.</li>
<li>Modify <strong>br3-cedge1</strong> device template that you created from day1; add SIG template, <strong>CX_SIG_v1</strong> and pre-configured SIG credential template <strong>CX_SIG_Creden_v01</strong>.<br />
<strong>Note: The Umbrella API key is pre-configured in feature template 'CX_SIG_Creden_v01'. You don't need to modify it.</strong></li>
<li>
<p>Modify VPN1 feature template that you created from day1 for br3-cedge1; add 0.0.0.0/0 <strong>Service Route</strong> to use SIG tunnel.</p>
</li>
<li>
<p>Now verify br3-vm1 is using umbrella for internet bound traffic by checking what's my IP or simply traceroute.</p>
</li>
</ul>
<p><strong>3.4.5. Automation tool - Sastre</strong><br></p>
<p>Sastre is a Cisco internal developed automation tool for SD-WAN. Sastre is available in two flavors:</p>
<p><a href="https://github.com/CiscoDevNet/sastre">Sastre</a>: Public open-source under MIT license available on Cisco DevNet repository. Supports a limited set of tasks.</p>
<p><a href="https://wwwin-github.cisco.com/AIDE/Sastre-Pro">Sastre-Pro</a>: Cisco licensed version, supporting the full feature-set. Sastre-Pro is available for customers with a CX BCS subscription and internally at Cisco.</p>
<p>Download and install <a href="https://wwwin-github.cisco.com/AIDE/Sastre-Pro">Sastre-Pro</a>; backup all policies and templates from lab vManage to your local drive.  </p>
<p><strong>3.4.6. Upgrade</strong> <br>
Upgrade controllers to 20.6.1</p>
<h4 id="submit-your-saved-files-from-day-4-task-to-box-folder">Submit your saved files from Day 4 task to <a href="https://cisco.app.box.com/folder/126787795425">box folder</a></h4>
<p><br>
<em>Note</em>*: the step by step video below should be only used for reference
</br></br>
<a href="https://youtu.be/F7pOaXPaReM"><img src="https://img.youtube.com/vi/F7pOaXPaReM/0.jpg"></a>
</br></br></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../survey/" class="btn btn-neutral float-right" title="Survey">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../day3/" class="btn btn-neutral" title="Day 3 Tasks"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../day3/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../survey/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
